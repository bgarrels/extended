object M_Article: TM_Article
  OnCreate = DataModuleCreate
  OldCreateOrder = False
  left = 97
  top = 65516
  Height = 508
  HorizontalOffset = 491
  VerticalOffset = 208
  Width = 771
  object ds_article: TDatasource
    DataSet = zq_Article
    left = 128
    top = 13
  end
  object zq_Gamme: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'SELECT * from GAMME'
    )
    Params = <>
    UpdateObject = IBU_Gamme
    left = 477
    top = 13
  end
  object ds_Gamme: TDatasource
    DataSet = zq_Gamme
    left = 400
    top = 13
  end
  object zq_TypProduit: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'SELECT * from TYPE_PRODUIT'
    )
    Params = <>
    UpdateObject = IBU_TypProd
    left = 328
    top = 128
  end
  object ds_TypProduit: TDatasource
    DataSet = zq_TypProduit
    left = 216
    top = 128
  end
  object zq_Carac: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'SELECT * from CARACTERISTIQUE'
    )
    Params = <>
    UpdateObject = IBU_Carac
    left = 312
    top = 184
  end
  object ds_Carac: TDatasource
    DataSet = zq_Carac
    left = 217
    top = 184
  end
  object ds_FiltreProduit: TDatasource
    DataSet = zq_FiltreProduit
    left = 216
    top = 72
  end
  object zq_FiltreProduit: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'SELECT * FROM FILTRE_PRODUIT'
    )
    Params = <>
    left = 328
    top = 72
  end
  object zq_Article: TIBQuery
    Database = IBDatabase
    Transaction = IBTransaction
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'select * '
      'from ARTICLE'
    )
    Params = <>
    UpdateObject = IBU_Article
    left = 216
    top = 13
  end
  object IBDatabase: TIBDatabase
    Connected = False
    LoginPrompt = False
    AllowStreamedConnected = False
    DatabaseName = 'Exemple'
    Params.Strings = (
      'user_name=SYSDBA'
      'password=masterkey'
      'lc_ctype=UTF8'
    )
    DefaultTransaction = IBTransaction
    IdleTimer = 0
    TraceFlags = []
    left = 24
    top = 13
  end
  object IBTransaction: TIBTransaction
    Active = False
    left = 24
    top = 72
  end
  object ib_majTypArt: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'INSERT GAMME_TYPR SELECT distinct ARTI__GAMM,ARTI__TYPR from ARTICLE'
      'WHERE ARTI__TYPR NOT IN '
      '(select GATY__TYPR from GAMME_TYPR where GATY__GAMM = ARTI__GAMM) and ARTI__TYPR is not null and ARTI__GAMM is not null'
      ''
      'INSERT TYPE_PRODUIT_CARA SELECT distinct ARTI__TYPR,ARTI__CARA from ARTICLE'
      'WHERE ARTI__CARA NOT IN '
      '(select TYPC__CARA from TYPE_PRODUIT_CARA where TYPC__TYPR = ARTI__TYPR) and ARTI__CARA is not null '
      'and ARTI__TYPR is not null and ARTI__GAMM is not null'
    )
    Params = <>
    left = 88
    top = 216
  end
  object ib_typearti: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'select *'
      'from TYPE_PRODUIT'
    )
    Params = <>
    left = 88
    top = 160
  end
  object ds_typearti: TDatasource
    DataSet = ib_typearti
    left = 16
    top = 160
  end
  object ib_desaffecte: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'UPDATE ARTICLE SET ARTI__GAMM = null, ARTI__TYPR = null,ARTI__CARA = null'
      'WHERE ARTI_Clep =:codeart'
      ''
      ''
    )
    Params = <    
      item
        DataType = ftUnknown
        Name = 'codeart'
        ParamType = ptInput
      end>
    left = 88
    top = 352
    ParamData = <    
      item
        DataType = ftUnknown
        Name = 'codeart'
        ParamType = ptInput
      end>
  end
  object ib_majGamme: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'INSERT GAMME_TYPR SELECT distinct ARTI__GAMM,ARTI__TYPR from ARTICLE'
      'WHERE ARTI__TYPR NOT IN '
      '(select GATY__TYPR from GAMME_TYPR where GATY__GAMM = ARTI__GAMM) and ARTI__TYPR is not null and ARTI__GAMM is not null'
      ''
      'INSERT TYPE_PRODUIT_CARA SELECT distinct ARTI__TYPR,ARTI__CARA from ARTICLE'
      'WHERE ARTI__CARA NOT IN '
      '(select TPCA__CARA from TYPR_CARA where TYPE_PRODUIT_CARA = ARTI__TYPR) and ARTI__CARA is not null and ARTI__TYPR is not null and ARTI__GAMM is not null'
      ''
      ''
    )
    Params = <>
    left = 16
    top = 352
  end
  object ib_gammarti: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'select ARTI_Clep, ARTI_Libcom'
      'from ARTICLE'
      'where ARTI__GAMM = :gamm'
      'ORDER BY ARTI_Libcom'
    )
    Params = <    
      item
        DataType = ftUnknown
        Name = 'gamm'
        ParamType = ptInput
      end>
    left = 88
    top = 288
    ParamData = <    
      item
        DataType = ftUnknown
        Name = 'gamm'
        ParamType = ptInput
      end>
  end
  object ds_gammarti: TDatasource
    DataSet = ib_gammarti
    left = 16
    top = 288
  end
  object ib_majcara: TIBQuery
    BufferChunks = 1000
    CachedUpdates = False
    GeneratorField.ApplyOnEvent = gaeOnNewRecord
    SQL.Strings = (
      'INSERT GAMME_TYPR SELECT distinct ARTI__GAMM,ARTI__TYPR from ARTICLE'
      'WHERE ARTI__TYPR NOT IN '
      '(select GATY__TYPR from GAMME_TYPR where GATY__GAMM = ARTI__GAMM) and ARTI__TYPR is not null and ARTI__GAMM is not null'
      ''
      'INSERT TYPE_PRODUIT_CARA SELECT distinct ARTI__TYPR,ARTI__CARA from ARTICLE'
      'WHERE ARTI__CARA NOT IN '
      '(select TYPC__CARA from TYPE_PRODUIT_CARA where TYPC__TYPR = ARTI__TYPR) and ARTI__CARA is not null '
      'and ARTI__TYPR is not null and ARTI__GAMM is not null'
      ''
      ''
    )
    Params = <>
    left = 280
    top = 344
  end
  object Process: TProcess
    Active = False
    Options = []
    Priority = ppNormal
    StartupOptions = []
    ShowWindow = swoNone
    WindowColumns = 0
    WindowHeight = 0
    WindowLeft = 0
    WindowRows = 0
    WindowTop = 0
    WindowWidth = 0
    FillAttribute = 0
    left = 536
    top = 328
  end
  object IBU_Article: TIBUpdateSQL
    ModifySQL.Strings = (
      'UPDATE ARTICLE SET'
      '     ARTI_Libcom=:ARTI_Libcom,'
      #9'ARTI__CARA=:ARTI__CARA,'
      #9'ARTI__TYPR=:ARTI__TYPR,'
      #9'ARTI__GAMM=:ARTI__GAMM '
      'WHERE ARTI_CLEP=:ARTI_CLEP'
    )
    InsertSQL.Strings = (
      'INSERT INTO ARTICLE'
      '     (  ARTI_Libcom,'
      #9'ARTI__CARA,'
      #9'ARTI__TYPR,'
      #9'ARTI__GAMM) '
      'VALUES'
      '     (  :ARTI_Libcom,'
      #9':ARTI__CARA,'
      #9':ARTI__TYPR,'
      #9':ARTI__GAMM) '
    )
    DeleteSQL.Strings = (
      'DELETE FROM ARTICLE WHERE ARTI_CLEP = :ARTI_CLEP'
    )
    left = 312
    top = 8
  end
  object IBU_Gamme: TIBUpdateSQL
    ModifySQL.Strings = (
      'UPDATE GAMME SET'
      '     GAMM_Libelle=:GAMM_Libelle '
      'WHERE GAMM_CLEP=:GAMM_CLEP'
    )
    InsertSQL.Strings = (
      'INSERT INTO GAMME'
      '     (  GAMM_Libelle) '
      'VALUES'
      '     (  :GAMM_Libelle) '
    )
    DeleteSQL.Strings = (
      'DELETE FROM GAMME WHERE GAMM_CLEP = :GAMM_CLEP'
    )
    left = 608
    top = 13
  end
  object IBU_TypProd: TIBUpdateSQL
    ModifySQL.Strings = (
      'UPDATE TYPE_PRODUIT SET'
      '     TYPR_Libelle=:TYPR_Libelle '
      'WHERE TYPR_CLEP=:TYPR_CLEP'
    )
    InsertSQL.Strings = (
      'INSERT INTO TYPE_PRODUIT'
      '     (  TYPR_Libelle) '
      'VALUES'
      '     (  :TYPR_Libelle) '
    )
    DeleteSQL.Strings = (
      'DELETE FROM TYPE_PRODUIT WHERE TYPR_CLEP = :TYPR_CLEP'
    )
    left = 432
    top = 128
  end
  object IBU_Carac: TIBUpdateSQL
    ModifySQL.Strings = (
      'UPDATE CARACTERISTIQUE SET'
      '     CARA_Libelle=:CARA_Libelle '
      'WHERE CARA_CLEP=:CARA_CLEP'
    )
    InsertSQL.Strings = (
      'INSERT INTO CARACTERISTIQUE'
      '     (  CARA_Libelle) '
      'VALUES'
      '     (  :CARA_Libelle) '
    )
    DeleteSQL.Strings = (
      'DELETE FROM CARACTERISTIQUE WHERE CARA_CLEP = :CARA_CLEP'
    )
    left = 432
    top = 184
  end
end
